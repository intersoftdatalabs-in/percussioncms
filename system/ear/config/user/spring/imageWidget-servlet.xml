<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~     Percussion CMS
  ~     Copyright (C) 1999-2020 Percussion Software, Inc.
  ~
  ~     This program is free software: you can redistribute it and/or modify
  ~     it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
  ~
  ~     This program is distributed in the hope that it will be useful,
  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~     GNU Affero General Public License for more details.
  ~
  ~     Mailing Address:
  ~
  ~      Percussion Software, Inc.
  ~      PO Box 767
  ~      Burlington, MA 01803, USA
  ~      +01-781-438-9900
  ~      support@percussion.com
  ~      https://www.percussion.com
  ~
  ~     You should have received a copy of the GNU Affero General Public License along with this program.  If not, see <https://www.gnu.org/licenses/>
  -->

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-4.2.xsd">

   <bean id="imageWidgetBinaryUpload" class="com.percussion.widgets.image.web.impl.BinaryUploadController">
      <property name="cacheManager" ref="imageWidgetCacheManager" />
      <property name="viewName" value="imageWidgetJSONView" />
      <property name="modelObjectName" value="results" />
    </bean>
    
    <bean id="imageWidgetBinaryDisplay" class="com.percussion.widgets.image.web.impl.BinaryImageController">
       <property name="cacheManager" ref="imageWidgetCacheManager" /> 
    </bean>
    
    <bean id="imageWidgetRequestImage" class="com.percussion.widgets.image.web.impl.ImageRequestController">
       <property name="imageCacheManager" ref="imageWidgetCacheManager" />
       <property name="supportedMethods" value="GET" /> 
       <property name="modelObjectName" value="results" />
       <property name="viewName" value="imageWidgetJSONView" /> 
    </bean>
    
    <bean id="imageWidgetResize" class="com.percussion.widgets.image.web.impl.ImageResizeController">
        <property name="viewName" value="imageWidgetJSONView" /> 
        <property name="modelObjectName" value="results" />
        <property name="imageCacheManager" ref="imageWidgetCacheManager" /> 
        <property name="imageResizeManager" ref="imageWidgetResizeManager" /> 
         
    </bean>
    
    <bean id="imageWidgetViewResolver" class="org.springframework.web.servlet.view.BeanNameViewResolver">
       <property name="order" value="1" /> 
    </bean>
    
    
    <bean id="imageWidgetJSONView" class="com.percussion.widgets.image.web.impl.JSONView">
        <property name="contentType" value="application/json" />
        <property name="modelObjectName" value="results" /> 
    </bean>
    
    
   <bean id="imageWidgetUrlMapping"
   	class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
   	<property name="mappings">
   	    <value>
   	       /imageWidget/image/img*.*=imageWidgetBinaryDisplay
   	       /imageWidget/upload*=imageWidgetBinaryUpload
   	       /imageWidget/requestImage.do=imageWidgetRequestImage
   	       /imageWidget/resizeImage.do=imageWidgetResize
   	    </value>
   	</property>
   </bean>

</beans>
