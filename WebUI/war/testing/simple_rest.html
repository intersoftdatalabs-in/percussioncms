<!--
  ~     Percussion CMS
  ~     Copyright (C) 1999-2020 Percussion Software, Inc.
  ~
  ~     This program is free software: you can redistribute it and/or modify
  ~     it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
  ~
  ~     This program is distributed in the hope that it will be useful,
  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~     GNU Affero General Public License for more details.
  ~
  ~     Mailing Address:
  ~
  ~      Percussion Software, Inc.
  ~      PO Box 767
  ~      Burlington, MA 01803, USA
  ~      +01-781-438-9900
  ~      support@percussion.com
  ~      https://www.percusssion.com
  ~
  ~     You should have received a copy of the GNU Affero General Public License along with this program.  If not, see <https://www.gnu.org/licenses/>
  -->

<html>
 <head>
  <script src="../jslib/jquery-1.3.2.js"></script>
  <script src="../jslib/profiles/3x/jquery/plugins/jquery-perc-retiredjs/json2.js"></script>
  <script src="../jslib/profiles/3x/jquery/plugins/jquery-form/jquery.form.js"></script>
  <!-- PSJSUtils.js must come after jQuery core js file -->
  <script src="../jslib/profiles/3x/jquery/plugins/jquery-percutils/jquery.percutils.js"></script>
  <script src="../plugins/perc_path_constants.js"></script>
  <script src="../jslib/jquery-ui-1.7.2.custom.js"></script>
  <script src="../plugins/perc_utils.js"></script>
  <script src="..jslib/profiles/3x/jquery/plugins/jquery-layout/jquery.layout_and_plugins.js"></script>
  <script src="../jslib/profiles/3x/jquery/plugins/jquery-perc-retiredjs/jquery.metadata.js"></script>
  <script src="../jslib/profiles/3x/jquery/plugins/jquery-perc-retiredjs/tools.scrollable-1.1.2.js"></script>
  <script src="../jslib/profiles/3x/jquery/plugins/jquery-perc-retiredjs/tools.scrollable.mousewheel-1.0.1.js"></script>
  <script src="../jslib/profiles/3x/jquery/plugins/jquery-validation/jquery.validate.js"></script>
  <script src="../plugins/perc_extend_jQueryValidate.js"></script>
  <script src="../jslib/ui/ui.core.js"></script>
  <script src="../jslib/ui/ui.draggable.js"></script>
  <script src="../jslib/ui/ui.droppable.js"></script>
  <script src="../jslib/ui/ui.dialog.js"></script>
  <script>
       ;
       $('document').ready( function(){
               populateWidgetLibrary();
       });

       function populateWidgetLibrary(){
          $('#perc-widget-library').empty();
	  $.getJSON($.perc_paths.WIDGETS_ALL, function(js) {
                       $.each( js['WidgetSummary'], function( ) {
                                  $('#perc-widget-library').append( mk_widget( this ) );
                               }); });
       }

       function mk_widget(w) {
          var wdg;
          wdg = $("<div/>") 
	    .css({'position': 'relative', 'width': '200px'})
	    .addClass("perc-widget-tool")
	    .append($("<span/>").append(w['label']).addClass("perc-widget-label") )
	    .append( $("<img src=\"" + w['icon'] + "\" alt=\"\"></img>") )
	    .attr('id',"widget-" + w['id'] + "-" + $('.perc-widget').size())
            .draggable({
                  appendTo: 'body',
                  helper: 'clone',
                  revert: true
                  });
          wdg.data( 'widget', w );
          return wdg;
    }
  </script>
  <body>
    <div id="perc-widget-library"></div>
  </body>
</html>
